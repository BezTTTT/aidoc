{% extends "./header.html"%}

{% block content %}

<h2 class="text-center">
    ระบบปัญญาประดิษฐ์ที่ช่วยในการค้นหาและวิเคราะห์รอยโรคก่อนมะเร็งและมะเร็งช่องปาก
</h2>
<h4 class="text-center">
    (Artificial Intelligent System for Detecting and Analyzing PMDs and Oral
    Cancer)
</h4>

{% if data.get('image') is none %}
  <div class="container-fluid">
    <div style="width: auto">{% if data.get('preview_image') is none %}</div>
    <div class="row d-flex justify-content-center align-items-center text-center">
      <div class="col-8 col-xs-2 d-flex justify-content-center align-items-center">
        <form class="p-3 text-center" action="/preview_image" method="post" enctype="multipart/form-data">
          <input id="file-upload1" type="file" name="imagefile[]" onchange="form.submit()" multiple accept="image/*" hidden />
          <div class="d-flex align-items-center" style="width: 100%">
            <label for="file-upload1" class="card d-flex justify-content-center align-items-center" style="
                  border-style: dashed;
                  border-color: rgb(0, 229, 255); 
                  border-width: 2px;
                  width: 22rem;
                  height: 20  rem;
                  cursor: pointer;
                  padding: 10px;
                ">
              <div class="d-flex justify-content-center align-items-center img-responsive">
                <img src=static/upload_icon.png style="width: 30%;"
                class="card-img-top">
              </div>
              คลิกเพื่ออัพโหลดรูปภาพ
              <br />(กรุณาอัพโหลดรูปช่องปากที่ได้มาตรฐานเท่านั้น)
            </label>
          </div>
        </form> 
  {% else %}
        <div class="p-3 text-center d-flex justify-content-center">
          <div class="col-md-4">
            <img id="previewImage" src="{{data['preview_image']}}" class="card d-flex mx-auto" alt="" />
            <div class="my-3">
              <a class="btn btn-outline-primary mb-2" href="{{url_for('prediction_blueprint.prediction_main')}}">เปลี่ยนรูป</a>
              <form action="/rotate_img" method="post" enctype="multipart/form-data">
                <input type="text" name="image_path" value="{{data['preview_image']}}" hidden />
                <input class="btn btn-outline-primary mb-2" type="submit" value="หมุนรูปไปทางขวา" />
              </form>

              <!-- +++++++++++++++++++++++ User ++++++++++++++++++++++++++ -->
              {% if data['role'] != "patient" %}
                <form id="submitimgForm" action="/" method="post" enctype="multipart/form-data" >
                  <input type="text" name="fname" value="{{data['preview_image']}}" hidden />
                  <!-- <input id="submitbtn" onclick="disableButton();" class="btn btn-primary mb-2" type="submit" value="ยืนยัน" /> -->
                  <div id="submitbtn" onclick="disableButton()" class="btn btn-success mb-2">ยืนยัน</div>

                  <!-- +++++++++++++++++++++++ อสม. ++++++++++++++++++++++++++ -->
                  {% if data['work'] == "อสม."%}
                    <div id="errorBox" class="alert alert-danger" role="alert" style="display: none;"></div>

                    <div class="border p-3 rounded-3 my-2">
                      <div class="row justify-content-center">
                        <div class="d-flex align-items-center justify-content-center mb-2">
                          <p class="card-title">
                            <!-- <span  style="color: red; font-weight: bold;">สำคัญ: </span> -->
                            รหัสไปรษณีย์ของสถานที่เก็บข้อมูล
                          </p>
                        </div>

                        <div class="d-flex align-items-center col-md-6">
                          <input class="form-control" placeholder="รหัสไปรษณีย์ 5 หลัก" maxlength="5" type="text" name="inputZipCode" id="inputZipCode" 
                            required
                            {%if data['zip_code']!='' %} value={{data['zip_code']}} {%endif%}
                          /> 
                        </div>
                      </div>
                    </div>
                    <div class="border p-3 rounded-3">
                      <div class="row justify-content-center">
                        <div class="d-flex align-items-center justify-content-center mb-2">
                          <p class="card-title">
                            เลขประจำตัวประชาชนของผู้ป่วย
                          </p>
                        </div>

                        <div class="d-flex align-items-center col-md-8">
                          <input class="form-control" placeholder="เลขประจำตัวประชาชน..." maxlength="13" type="text" name="inputIdentityID" id="inputIID"/> 
                        </div>

                        <div class="mt-3" id="patientInfoContainer"></div>
                      </div>
                    </div>
                    <script>
                      const iidInputBox = document.getElementById('inputIID')
                      const patientInfoBox = document.getElementById('patientInfoContainer')
        
                      iidInputBox.addEventListener('input',function(e){
                        checkIdentityID( iid = e.target.value)
                      })
        
                      function checkIdentityID(iid){
                        console.log("iid:",iid )
                        if(iid.length == 13){
                            // Make an AJAX request to Flask server
                          var xhr = new XMLHttpRequest();
                          xhr.open('POST', '/find_patient', true);
                          xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                          xhr.onreadystatechange = function () {
                            if (xhr.readyState === 4 && xhr.status === 200) {
                                // var resultDiv = document.getElementById('result');
                                // resultDiv.innerHTML = 'Result: ' + JSON.parse(xhr.responseText).result;
                                var patientInfo = JSON.parse(xhr.responseText)
                                patientInfoBox.style.display = 'block'
                                patientInfoBox.style.color = 'green'
                                console.log("name :",patientInfo.name )
                                patientInfoBox.innerHTML = "ผู้ป่วยชื่อ "+patientInfo.fullname
                                
                            }else{
                              console.log("not found Info")
                              patientInfoBox.style.display = 'none'
                            
                            }
                          }
                              // Send the input value to the server
                          xhr.send('identity_id=' + iid);
                        }else{
                          patientInfoBox.style.display = 'none'
                          patientInfoBox.innerHTML=""
                        }
                      }
                      function isValidZipCode(zipCode) {
                        const zipCodePattern = /^\d{5}$/
                        return zipCodePattern.test(zipCode)
                      }
        
                      function isValidIdentityID(identityID) {
                        const identityIDPattern = /^\d{13}$/
                        return identityIDPattern.test(identityID)
                      }
                    

                      function disableButton() {
                      
                          let inputPhone = document.getElementById('inputPhone')
                          let inputZipCode = document.getElementById('inputZipCode')
                          let inputIID = document.getElementById('inputIID')
                          let checkbox = document.getElementById('checkbox')
                          
                          if (inputZipCode!=null) {
                            if(!(isValidZipCode(inputZipCode.value) || inputZipCode.value == '')){
                              let errorBox = document.getElementById("errorBox")
                              errorBox.style.display = 'block'
                              inputZipCode.style.borderColor = 'red'
                              inputIID.style.borderColor = ''
                              errorBox.innerHTML = 'กรุณากรอกรหัสไปรษณีย์ให้ถูกต้อง'
                              return
                            }else {
                              inputZipCode.style.borderColor = ''
                            }
                          }
          
                          if (!(isValidIdentityID(inputIID.value) || inputIID.value == '')) {
                            let errorBox = document.getElementById("errorBox")
                            errorBox.style.display = 'block'
                            inputIID.style.borderColor = 'red'
                            errorBox.innerHTML = 'กรุณากรอกเลขประจำตัวประชาชนให้ถูกต้อง'
                            return
                          } else {
                            let errorBox = document.getElementById("errorBox")
                            errorBox.style.display = 'none'
                            inputIID.style.borderColor = ''
                            errorBox.innerHTML = ''
                          }
          
                            document.getElementById("submitbtn").disabled = true
                            document.getElementById("submitbtn").onclick = null
                            document.getElementById("submitimgForm").submit()
        
                      }
                    </script>
                    <!-- +++++++++++++++++++++++ อสม.(end) ++++++++++++++++++++++++++ -->

                  {% else%}
                  <script>
                
                        function disableButton() {
                    
                        document.getElementById("submitbtn").disabled = true
                        document.getElementById("submitbtn").onclick = null
                        document.getElementById("submitimgForm").submit()
                        
                        
                      }
                  </script>
                  {% endif %}
                  <!-- +++++++++++++++++++++++ User(end) ++++++++++++++++++++++++++ -->

                </form>
                <!-- +++++++++++++++++++++++ Pratient ++++++++++++++++++++++++++ -->
              {% else %}
                <form id="submitimgForm" action="/" method="post" enctype="multipart/form-data">
                  <input type="text" name="fname" value="{{data['preview_image']}}" hidden />
                  <!-- <input id="submitbtn" onclick="disableButton();" class="btn btn-primary mb-2" type="submit" value="ยืนยัน" /> -->
                  <div id="submitbtn" onclick="disableButton()" class="btn btn-success mb-2">ยืนยัน</div>

                  <div id="errorBox" class="alert alert-danger" role="alert" style="display: none;">  
                  </div>

                  <div class="border p-3 rounded-3 my-2">
                    <div class="card-body">
                      <div class="row justify-content-center">
                        <div class="d-flex align-items-center justify-content-start">
                          <p class="card-title text-start">
                            <!-- <span  style="color: red; font-weight: bold;">สำคัญ: </span> -->
                            ขอความร่วมมือแจ้งรหัสไปรษณีย์ เพื่อระบุสถานที่ ที่ท่านถ่ายรูปภาพนี้ (หากไม่ทราบให้ปล่อยว่างไว้)
                          </p>
                        </div>
                        <div class="mt-2 col-md-6">
                          <input class="form-control" placeholder="รหัสไปรษณีย์ 5 หลัก" maxlength="5" type="text" name="inputZipCode" id="inputZipCode" 
                            required
                            {%if data['zip_code']!='' %} value={{data['zip_code']}} {%endif%}
                          /> 
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="loginContainer border p-3 rounded-3 my-2">
                    <div class="card-body text-start">
                      <p class="card-title">
                        <span  style="color: red; font-weight: bold;">สำคัญ: </span>
                        หากภาพนี้ถูกนำส่งโดยอสม. กรุณากดใช่ เพื่อแจ้งเบอร์โทร อสม. เพื่อประโยชน์ต่อการติดต่อกลับ แต่หากท่านส่งภาพนี้ด้วยตัวท่านเอง กรุณากดยกเลิก
                      </p>
                      <div class="row mt-2 justify-content-center">
                        <div class="col-4">
                          <input type="checkbox" name="checkbox" class="btn-check" id="checkbox" autocomplete="off" 
                            onchange="displayPhoneInput()"
                            checked
                          />
                          <label id="checkboxYes" class="btn" for="checkbox">ใช่</label>
                          <label id="checkboxNo" style="display: block;" class="btn btn-outline-danger" for="checkbox">ยกเลิก</label>
                        </div>
                        <div id="inputPhoneContainer" class="col-8" style="display: block;">
                          <input class="form-control" placeholder="เบอร์โทร..." maxlength="10" type="text" name="inputPhone" id="inputPhone" 
                            {% if data["has_sender"] %}
                              value="{{data['sender_phone']}}"
                            {% endif %}
                            required
                          /> 
                        </div>
                        <div class="mt-3 d-flex justify-content-center align-items-center" id="senderInfoContainer"
                          {% if data["has_sender"] %} style="display: none;" {% endif %}
                        ></div>
                      </div>
                    </div>
                  </div>
                </form>

                <script>
                  //sender info seaching
                  const phoneInputBox = document.getElementById('inputPhone')
                  const senderInfoBox = document.getElementById('senderInfoContainer')
                  //initial if there fetched phone num
                  let isFirstOpen = true
                  checkSenderPhone(inputPhone.value)

                  phoneInputBox.addEventListener('input',function(e){
                      checkSenderPhone( phone = e.target.value)
                  })

                  function checkSenderPhone(phone){
                    console.log("phone:",phone )
                    if(phone.length == 10){
                        // Make an AJAX request to Flask server
                      var xhr = new XMLHttpRequest();
                      xhr.open('POST', '/find_sender', true);
                      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                      xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            // var resultDiv = document.getElementById('result');
                            // resultDiv.innerHTML = 'Result: ' + JSON.parse(xhr.responseText).result;
                            var senderInfo = JSON.parse(xhr.responseText)
                            senderInfoBox.style.display = 'block'
                            senderInfoBox.style.color = 'green'
                            // console.log("name :",senderInfo.name," surname:",senderInfo.surname)
                            senderInfoBox.innerHTML = "อสม. ชื่อ "+senderInfo.name+" "+senderInfo.surname
                            isFirstOpen = false
                        }else{
                          console.log("not found Info")
                          senderInfoBox.style.display = 'none'
                          isFirstOpen = false
                        }
                      }
                          // Send the input value to the server
                      xhr.send('phone_number=' + phone);
                    }else{
                      senderInfoBox.style.display = 'none'
                      senderInfoBox.innerHTML=""
                      if (isFirstOpen) {
                        isFirstOpen = false
                        let checkbox = document.getElementById('checkbox')
                        let inputPhoneContainer = document.getElementById('inputPhoneContainer')
                        let checkboxYes = document.getElementById('checkboxYes')
                        let checkboxNo = document.getElementById('checkboxNo')

                        checkbox.checked = false
                        checkboxYes.style.display = 'block'
                        checkboxNo.style.display = 'none'
                        inputPhoneContainer.style.display = 'none'
                      }
                    }
                  }

                  function isValidZipCode(zipCode) {
                    const zipCodePattern = /^\d{5}$/
                    return zipCodePattern.test(zipCode)
                  }

                  function isValidPhoneNumber(phoneNumber) {
                    const phonePattern = /^\d{10}$/
                    return phonePattern.test(phoneNumber)
                  }

              
                  function disableButton() {
                
                      let inputPhone = document.getElementById('inputPhone')
                      let inputZipCode = document.getElementById('inputZipCode')
                      let checkbox = document.getElementById('checkbox')

                      if (!(isValidZipCode(inputZipCode.value) || inputZipCode.value == '')) {
                        let errorBox = document.getElementById("errorBox")
                        errorBox.style.display = 'block'
                        inputZipCode.style.borderColor = 'red'
                        inputPhone.style.borderColor = ''
                        errorBox.innerHTML = 'กรุณากรอกรหัสไปรษณีย์ให้ถูกต้อง'
                        return
                      } else {
                        let errorBox = document.getElementById("errorBox")
                        errorBox.style.display = 'none'
                        inputZipCode.style.borderColor = ''
                        errorBox.innerHTML = ''
                      }

                      if (checkbox.checked) {
                        if (!isValidPhoneNumber(inputPhone.value)) {
                          let errorBox = document.getElementById("errorBox")
                          errorBox.style.display = 'block'
                          inputPhone.style.borderColor = 'red'
                          errorBox.innerHTML = 'กรุณากรอกเบอร์โทรศัพท์ให้ถูกต้อง'
                        } else {
                          inputPhone.style.borderColor = ''
                          document.getElementById("submitbtn").disabled = true
                          is_submitted_patient = true
                          document.getElementById("submitimgForm").submit()
                          
                        }
                      }else {
                        document.getElementById("submitbtn").disabled = true
                        document.getElementById("submitbtn").onclick = null
                        document.getElementById("submitimgForm").submit()
                        
                      }
                    
                  }

                  function displayPhoneInput(){
                    var checkbox = document.getElementById('checkbox');
                    var inputPhone = document.getElementById('inputPhone');
                    var inputPhoneContainer = document.getElementById('inputPhoneContainer');
                    let checkboxYes = document.getElementById('checkboxYes')
                    let checkboxNo = document.getElementById('checkboxNo')
                    let errorBox = document.getElementById("errorBox")
                    
                    if (checkbox.checked) {
                      checkboxYes.style.display = 'none'
                      checkboxNo.style.display = 'block'
                      inputPhoneContainer.style.display = 'block'
                    } else {
                      checkboxYes.style.display = 'block'
                      checkboxNo.style.display = 'none'
                      inputPhoneContainer.style.display = 'none'
                    }

                    errorBox.style.display = 'none'
                    inputPhone.style.borderColor = ''
                    senderInfoBox.innerHTML = ""
                    senderInfoBox.style.display = 'none'
                    inputPhone.value = ""
                  }
                </script>
              {% endif %}
              <!-- +++++++++++++++++++++++ Pratient(end) ++++++++++++++++++++++++++ -->

              <script>
                document.title = "AIDOC | Preview Image"
                document.addEventListener('DOMContentLoaded', function() {
                    var previewImage = document.getElementById('previewImage');

                    // Check if the image has loaded
                    previewImage.onload = function() {
                      handleImageDimensions(previewImage);
                    };

                    // If the image is cached and already loaded
                    if (previewImage.complete) {
                      handleImageDimensions(previewImage);
                    }
                  });

                  function handleImageDimensions(imageElement) {
                    var maxWidthPercent = 100;
                    var maxHeight = 512;

                    // Set the image width to 100%
                    imageElement.style.width = maxWidthPercent + '%'
                    
                    // Calculate the new height based on the width
                    var newHeight = imageElement.naturalHeight * imageElement.width / imageElement.naturalWidth

                    // console.log('newHeight: ', newHeight, imageElement.width, imageElement.naturalWidth)
                    // Check if the new height exceeds 512px
                    if (newHeight > maxHeight) {
                      imageElement.style.width = ''
                      imageElement.style.maxWidth = '100%'
                      imageElement.style.maxHeight = maxHeight + 'px'
                    } else {
                      imageElement.style.width = '100%'
                      imageElement.style.maxWidth = ''
                      imageElement.style.maxHeight = maxHeight + 'px'
                    }
                  }
              </script>
            </div>
          </div>
        </div>
  {% endif %}
    </div>
  </div>

  <div>

    <div class="col-12 col-xs-2 d-flex justify-content-center">
      <div class="card mb-4" style="width: 100%">
        <div class="card-body">
          <h5 class="card-title text-center">เพื่อให้การตรวจวินิจฉัยเป็นไปอย่างครอบคลุมและแม่นยำ กรุณาดำเนินการคัดกรองตามขั้นตอนดังนี้</h5>
          <div class="section">
            <p class="card-text">1. ถ่ายภาพโดยเอียงกล้องเป็นแนวนอน ขนานกับริมฝีปาก</p>
            <p class="card-text">2.	เปิดแฟลชเพื่อให้มีแสงสว่างที่เพียงพอ</p>
            <p class="card-text">3.	ใช้กล้องมือถือคุณภาพดี ถ่ายเห็นรายละเอียดภายในช่องปากอย่างชัดเจนและคมชัด</p>
            <p class="card-text">4.	นำส่งรูปให้ครบทุก<b>มุมมองมาตรฐาน</b>ในการตรวจสุขภาพช่องปาก ตามตัวอย่าง ดังนี้</p>
          </div>
          <div class="card mb-4 mt-1" style="width: 100%">
            <div class="card-body">
              <h5 class="card-title text-center">ตัวอย่างมุมมองมาตรฐาน</h5>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture1.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture2.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture3.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">ริมฝีปาก กลาง/บน/ล่าง(Lip)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-6 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture4.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-6 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture5.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">กระพุ้งแก้ม ด้านซ้าย/ขวา(Buccal mucosa)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture6.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture7.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture8.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">เหงือก ด้านซ้าย/กลาง/ขวา(Gingiva)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-6 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture9.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-6 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture10.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">เหงือกด้านหลังฟันกรามล่าง ด้านซ้าย/ขวา(Retromolar area)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-12 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture11.jpg style="height: 200px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">เพดานอ่อน เพดานแข็ง(Hard and Soft palate)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture12.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture13.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                    <div class="col-md-4 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture14.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">ลิ้น ด้านบน/ข้างซ้าย/ข้างขวา(Dorsal and lateral tongue)</p>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-center">
                <div class="card mt-2">
                <div class="card-body d-flex justify-content-evenly">
                  <div class="row d-flex justify-content-center">
                    <div class="col-md-12 d-flex justify-content-evenly">
                      <img src=static/examplepic/Picture15.jpg style="height: 150px;"
                      class="card-img-top">
                    </div>
                  </div>
                </div>
                  <div class="card-body">
                    <p class="card-text d-flex justify-content-center">ใต้ลิ้นและพื้นปาก(Ventral tongue and floor of mouth)</p>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    <div class="row d-flex justify-content-center align-items-center mt-5">
      <div class="col-12 col-xs-2 d-flex justify-content-center">
        <div class="card mb-4" style="width: 100%">
          <div class="card-body d-flex justify-content-evenly">
            <div class="row d-flex justify-content-center">
              <div class="col-md-3 d-flex justify-content-evenly">
                <img src="static/doh.png" class="card d-flex justify-content-center"
                  style="width: 50%; height: auto; border: 0" alt="" />
              </div>
              <div class="col-md-3 d-flex justify-content-around">
                <img src="static/cmu.png" class="card d-flex justify-content-center"
                  style="width: 50%; height: auto; border: 0" alt="" />
              </div>
              <div class="col-md-3 d-flex justify-content-around">
                <img src="static/tmu.png" class="card d-flex justify-content-center"
                  style="width: 50%; height: auto; border: 0" alt="" />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12 col-xs-2 d-flex justify-content-center">
        <div class="card" style="width: 100%">
          <div class="card-body">
            <h5 class="card-title text-center">คำชี้แจงและเงื่อนไขการใช้งาน</h5>
            <p class="card-text">
              1. โปรแกรมคอมพิวเตอร์นี้ชื่อว่า
              ระบบปัญญาประดิษฐ์ที่ช่วยในการค้นหาและวิเคราะห์รอยโรคก่อนมะเร็งและมะเร็งช่องปาก
              (Artificial Intelligent System for Detecting and Analyzing PMDs and
              Oral Cancer)
              ระบบนี้เป็นส่วนหนึ่งของโครงการการพัฒนาระบบการเฝ้าระวังด้านทันตสาธารณสุข
              ประเด็นการตรวจคัดกรองและประเมินปัจจัยเสี่ยงการเกิดรอยโรคก่อนมะเร็งและมะเร็งช่องปาก
              ซึ่งได้รับงบประมาณสนับสนุนและอยู่ภายใต้การกำกับดูแลของ
              ศูนย์ทันตสาธารณสุขระหว่างประเทศ กรมอนามัย กระทรวงสาธารณสุข
            </p>
            <p class="card-text">
              <b>2. (เงื่อนไขการใช้งาน) ระบบปัญญาประดิษฐ์ฯ นี้
                ไม่ใช่เครื่องมือทางการแพทย์
                ผลลัพธ์จากการประมวลผลไม่สามารถนำไปใช้วินิจฉัยหรืออ้างอิงในทางการแพทย์ใด
                ๆ ได้
                หากคนไข้ตรวจพบความผิดปกติหรือสงสัยว่ามีความผิดปกติของรอยโรคในช่องปาก
                คนไข้ต้องเข้ารับการตรวจวินิจฉัยและรักษาจากแพทย์หรือทันตแพทย์ผู้เชี่ยวชาญเท่านั้น</b>
            </p>
            <p class="card-text">
              3. ระบบปัญญาประดิษฐ์ฯ นี้
              รองรับข้อมูลเฉพาะที่เป็นภาพถ่ายช่องปากที่มีมุมมองได้มาตรฐาน
              มีขนาดของรอยโรคที่ใหญ่และชัดเจนเพียงพอ
              มีแสงสว่างที่เหมาะสมและสม่ำเสมอ
              จึงจะสามารถให้ผลลัพธ์การทำนายรอยโรคที่มีประสิทธิภาพได้
              ผู้ใช้สามารถศึกษาตัวอย่างภาพถ่ายที่เหมาะสมในเมนู
              “ตัวอย่างการทำนายรอยโรค”
            </p>
            <p class="card-text">
              4. ระบบปัญญาประดิษฐ์ฯ นี้ สามารถประมวลผลเฉพาะรอยโรคก่อนมะเร็ง (Oral
              Potentially Malignant Disorder หรือ OPMD) และรอยโรคมะเร็งช่องปากชนิด
              Oral Squamous Cell Carcinoma (หรือ OSCC) ได้เท่านั้น
              ไม่รองรับการประมวลผลรอยโรคทางช่องปากชนิดอื่น ๆ
              ตัวอย่างรูปภาพที่แสดงลักษณะรอยโรคที่ระบบรองรับ จะแสดงไว้ในเมนู
              “ตัวอย่างการทำนายรอยโรค”
            </p>
            <p class="card-text">
              <b>5. (เงื่อนไขการใช้งาน) ระบบปัญญาประดิษฐ์ฯ ที่เผยแพร่ต่อสาธารณะนี้
                ยังอยู่ระหว่างการวิจัยและพัฒนานวัตกรรม
                ระบบอาจยังไม่มีความสมบูรณ์เพียงพอ
                ระบบยังไม่ได้รับการตรวจสอบความถูกต้องแม่นยำจากหน่วยงานที่เกี่ยวข้องอย่างเข้มแข็ง
                และระบบอาจให้ผลลัพธ์ที่ผิดพลาดได้เสมอ ดังนั้น
                ศูนย์ทันตสาธารณสุขระหว่างประเทศและคณะผู้พัฒนา
                จะไม่รับผิดชอบในความเสียหายที่เกิดจากการใช้งาน ในกรณีใด ๆ ทั้งสิ้น
              </b>
            </p>
            <p class="card-text">
              <b>6. (เงื่อนไขการใช้งาน) การใช้งานระบบปัญญาประดิษฐ์ฯ นี้
                ผู้ใช้งานตกลงที่จะอนุญาตและมอบสิทธิ์ให้กับคณะผู้พัฒนาและหน่วยงานที่เกี่ยวข้อง
                ที่จะเก็บรักษาข้อมูล แก้ไข ทำซ้ำ เผยแพร่
                ซึ่งข้อมูลที่ผู้ใช้นำเข้าสู่ระบบคอมพิวเตอร์
                เพื่อนำไปปรับปรุงการทำงานของระบบปัญญาประดิษฐ์ฯ
                ให้มีความถูกต้องแม่นยำยิ่งขึ้นและเพื่อตอบโจทย์ทางด้านทันตสุขภาพและทันตสาธารณสุขของประเทศต่อไป</b>
            </p>
            <p class="card-text">
              7. เนื่องจากระบบปัญญาประดิษฐ์ฯ นี้ ยังไม่สมบูรณ์
              จำเป็นต้องได้รับการฝึกสอนโดยใช้ข้อมูลภาพถ่ายช่องปากที่ตรวจพบรอยโรคและช่องปากสุขภาพดี
              อีกเป็นจำนวนมาก ในโอกาสนี้ คณะผู้พัฒนา จึงขอขอบพระคุณผู้ใช้งานทุก ๆ
              ท่านที่นำส่งข้อมูลเข้าสู่ระบบอย่างต่อเนื่อง ทางเรามีความหวังใจว่า
              จะสามารถนำเสนอระบบปัญญาประดิษฐ์ที่มีความสมบูรณ์ต่อผู้ใช้งานในอนาคตอันใกล้นี้
            </p>
            <p class="card-text">
              8. หากผู้ใช้งานพบปัญหาจากการใช้งานหรือมีคำแนะนำอื่นใด
              ขอให้ท่านติดต่อได้ที่ ศูนย์ทันตสาธารณสุขระหว่างประเทศ กรมอนามัย
              กระทรวงสาธารณสุข เลขที่ 548 ต.หนองหอย อ.เมืองเชียงใหม่ จ.เชียงใหม่
              50000
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
{% else %}
  <div class="row d-flex justify-content-center text-center">
    <div class="col-md-4">
      <div class="card" {% if data['is_special'] %} style="border-color: red; border-width: 3px;" {% endif %}>
        <div
          class="mx-2 mt-2" 
          style="
            height: 300px;
            display: inline-flex; /* Use inline-flex to center horizontally */
            align-items: center; /* Center vertically */
            justify-content: center; /* Center horizontally */
            overflow: hidden;
          ">
          <a href="/static/images/inputs/{{ session['fname'] }}" target="_blank">
            <img id="showImg" src="{{data['image']}}" alt=""
              style="height: 100%; max-width: 100%; width: auto" />
          </a>
        </div>
        <div class="card-body">
          <p class="card-text">ภาพถ่ายช่องปาก</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card" {% if data['is_special'] %} style="border-color: red; border-width: 3px;" {% endif %}>
        <div
          class="mx-2 mt-2"
          style="
            height: 300px;
            display: inline-flex; /* Use inline-flex to center horizontally */
            align-items: center; /* Center vertically */
            justify-content: center; /* Center horizontally */
            overflow: hidden;
          ">
          <a href="/static/images/bordering_overlap/{{session['fname'] }}" target="_blank">
            <img src="{{data['segment_image']}}" alt="..."
              style="height: 100%; max-width: 100%; width: auto" />
          </a>
        </div>
        <div class="card-body">
          <p class="card-text">ภาพ AI ระบุรอยโรค</p>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-center container-md">
    {% if id is not none %}
    <!-- <div class="container"> -->
    <div class="row justify-content-center my-4" style="width: 90%;">
      <div class="col-md-3 text-center mt-2 px-1">
        <a class="btn btn-outline-success btn-block nowrap" style="width: 100%; margin: 0;"
          href="{{url_for('prediction_blueprint.prediction_main')}}">วิเคราะห์รูปภาพอื่นเพิ่มเติม</a>
      </div>
      {%if data['work'] != 'อสม.'%}
        <div class="col-md-2 text-center mt-2 px-1">
          <form action="/history?page={{data['current_page']}}" method="post" enctype="multipart/form-data">
            <input type="text" name="current_history_page" value="{{data['current_page']}}" hidden />
            <input class="btn btn-outline-success btn-block"  style="width: 100%; margin: 0;" type="submit" value="ดูประวัติ" />
          </form>
        </div>
        <div class="col-md-2 text-center mt-2 px-1">
          <a class="btn btn-outline-success btn-block" style="width: 100%; margin: 0;" href="/download/{{ data['image'] }}" download>Download</a>
        </div>
        <div class="col-md-2 text-center mt-2 px-1">
          <form action="/rotate_img_history" method="post" enctype="multipart/form-data">
            <input type="text" name="all_data" value="{{data}}" hidden />
            <input class="btn btn-outline-success" type="submit" style="width: 100%; margin: 0;" value="หมุนรูปไปทางขวา" />
          </form>
        </div>
        <div class="col-md-2 text-center mt-2 px-1">
          <form action="/recompute" method="post" enctype="multipart/form-data">
            <input type="text" name="all_data" value="{{data}}" hidden />
            <input type="text" name="table" value="history" hidden />
            <input class="btn btn-outline-success" type="submit" style="width: 100%; margin: 0;" value="recompute" />
          </form>
        </div>
      {% endif %}
    </div>
    {% endif %}
  </div>

  {% if data['is_special'] %}
    <div class="col-md-4 d-flex justify-content-center" style="width: auto;">
      <div class="loginContainer border p-3 rounded-3 my-2">
        <div class="card-body text-start">
          <p class="card-title">
            <!-- <span  style="color: red; font-weight: bold;">สำคัญ: </span> -->
            ส่งคำขอตรวจสอบพิเศษเรียบร้อยแล้ว
          </p>
        </div>
      </div>
    </div>
  {% endif %}

  <div class="row d-flex justify-content-center text-align-left my-4" style="width: auto">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">ผลการวินิจฉัยของ AI</h5>
        {% if 'NM' in data['image_class'] %}
          <h6 class="card-subtitle card shadow-lg bg-success my-3 py-3 ms-4 fs-2 text-white text-center">
            ช่องปากของคุณไม่มีรอยโรค
          </h6>
        {% else %}
          {% if 'OPMD' in data['image_class'] %}
            <h6 class="card-subtitle card shadow-lg bg-warning my-3 py-3 fs-2 text-dark text-center">
              ช่องปากของคุณอาจมีรอยโรค OPMD (Oral Potentially Malignant Disorders)
            </h6>
          {% else %}
            <h6 class="card-subtitle card shadow-lg bg-danger my-3 py-3 ms-4 fs-2 text-white text-center">
              ช่องปากของคุณอาจมีรอยโรค OSCC (Oral Squamous Cell Carcinoma)
            </h6>
          {% endif %}
          <script>
            document.title = "AIDOC | Prediction"
          </script>
        {% endif %}

        <button id="seeMoreButton" class="btn btn-light" style="padding: 5px 10px; font-size: 13px;background-color:rgb(196, 196, 196);">
          <span class="bi bi-plus" ></span> ดูผลคำวินิจฉัยด้วย AI เพิ่มเติม
        </button>

        <div id="hiddenContent" class="m-2">
          <div class="row d-flex justify-content-center">
            <div class="col-1 d-flex justify-content-end" style="width: 33%">
              {% if 'NM' in data['image_class'] %}
                <input class="" type="checkbox" checked />
              {% else %}
                <input class="" type="checkbox" />
              {% endif %}
            </div>
            <div class="col-2" style="width: 33%">
              <p class="card-text">ความน่าจะเป็นที่จะไม่มีรอยโรค</p>
            </div>
            <div class="col-3" style="width: 33%">
              <p class="card-text">
                {{'%0.2f'| format(data['score'][0]|float)}} %
              </p>
            </div>
          </div>

          <div class="row justify-content-center" style="width: auto">
            <div class="col-1 d-flex justify-content-end" style="width: 33%">
              {% if 'OPMD' in data['image_class'] %}
                <input class="mt-2" type="checkbox" checked />
              {% else %}
                <input class="mt-2" type="checkbox" />
              {% endif %}
            </div>
            <div class="col-2" style="width: 33%">
              <p class="card-text">ความน่าจะเป็นของการมีรอยโรค OPMD</p>
            </div>
            <div class="col-3" style="width: 33%">
              <p class="card-text">
                {{'%0.2f'| format(data['score'][1]|float)}} %
              </p>
            </div>
          </div>

          <div class="row justify-content-center" style="width: auto">
            <div class="col-1 d-flex justify-content-end" style="width: 33%">
              {% if 'OSCC' in data['image_class'] %}
                <input class="mt-2" type="checkbox" checked />
              {% else %}
                <input class="mt-2 mb-2" type="checkbox" />
              {% endif %}
            </div>
            <div class="col-2" style="width: 33%">
              <p class="card-text">ความน่าจะเป็นของการมีรอยโรค OSCC</p>
            </div>
            <div class="col-3" style="width: 33%">
              <p class="card-text">
                {{'%0.2f'| format(data['score'][2]|float)}} %
              </p>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  {% if data['userId'] is not none and data['work'] != 'อสม.' %}
  <form action="/" method="post" enctype="multipart/form-data">
    <div class="row d-flex justify-content-center text-align-left my-4">
      <div class="card mb-5" style="width: 100%">
        <div class="card-body">
          <!-- {{ data }} -->
          <h5 class="card-title">
            ท่านเห็นด้วยกับผลการวิเคราะทาง AI ดังที่ปรากฏหรือไม่?
          </h5>
          {% if data['comment'] is none or data['comment'] == '' %}
            <div class="form-check">
              <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault1" value="เห็นด้วย"
                />
              <label class="form-check-label" for="comment_option">
                เห็นด้วย
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault2"
                value="ไม่เห็นด้วย" />
              <label class="form-check-label" for="comment_option">
                ไม่เห็นด้วย
              </label>
            </div>
            <h5 class="card-title mt-4">
              คำวินิจฉัยเพิ่มเติม
            </h5>
            <div class="d-flex justify-content-lg-start mb-4">
              <div>
                <!-- {{ data}} -->
                <label class="mb-1">ตำแหน่งที่ตรวจพบรอยโรค</label>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="1" {% if
                    data['position']==1 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    1.ริมฝีปากบนและล่าง (Lip)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="2" {% if
                    data['position']==2 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    2.กระพุ้งแก้มด้านขวาด้านซ้าย (Buccal mucosa)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="3" {% if
                    data['position']==3 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    3.เหงือกบนและล่าง (Gingiva)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="4" {% if
                    data['position']==4 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    4.เหงือกด้านหลังฟันกรามล่าง (Retromolar area)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="5" {% if
                    data['position']==5 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    5.เพดานแข็ง (Hard palate)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="6" {% if
                    data['position']==6 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    6.เพดานอ่อน (Soft palate)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="7" {% if
                    data['position']==7 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    7.ลิ้นด้านบนและด้านข้าง (Dorsal and lateral tongue)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="8" {% if
                    data['position']==8 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    8.ใต้ลิ้น (Ventral tongue)
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="9" {% if
                    data['position']==9 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    9.พื้นปาก (Floor of mouth)
                  </label>
                </div>
              </div>

              <div>
                <label class="mb-1">ชนิดรอยโรค</label>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="1"
                    {% if data['lesions']==1 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    รอยโรคสีขาว
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="2" {%
                    if data['lesions']==2 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    รอยโรคสีแดง
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1"
                    value="3" {% if data['lesions']==3 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    รอยโรคสีขาวปนแดง
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="4" {% if
                    data['lesions']==4 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    รอยแผลถลอก
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="5" {% if
                    data['lesions']==5 %}checked{% endif %} />
                  <label class="form-check-label" for="comment_option">
                    ลักษณะเป็นก้อน
                  </label>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="exampleFormControlTextarea1" class="form-label">ความคิดเห็น</label>
              <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="comment">{{data['comment']}}</textarea>
            </div>
          {% else %}
            {% if data['cb_comment'] == 'ไม่เห็นด้วย' %}
              <div class="form-check">
                <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault1" value="เห็นด้วย" />
                <label class="form-check-label" for="comment_option">
                  เห็นด้วย
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault2" value="ไม่เห็นด้วย"
                  checked />
                <label class="form-check-label" for="comment_option">
                  ไม่เห็นด้วย
                </label>
              </div>

              <h5 class="card-title mt-4">
                คำวินิจฉัยเพิ่มเติม
              </h5>

              <div class="d-flex justify-content-lg-start mb-4">
                <div>
                  <label class="mb-1">ตำแหน่งที่ตรวจพบรอยโรค</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="1"
                      {% if data['position']==1 %} checked {% endif %} />
                    <label class="form-check-label" for="comment_option">
                      1.ริมฝีปากบนและล่าง (Lip)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="2"
                      {% if data['position']==2 %} checked {% endif %} />
                    <label class="form-check-label" for="comment_option">
                      2.กระพุ้งแก้มด้านขวาด้านซ้าย (Buccal mucosa)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="3"
                      {% if data['position']==3 %} checked {% endif %} />
                    <label class="form-check-label" for="comment_option">
                      3.เหงือกบนและล่าง (Gingiva)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="4"
                      {% if data['position']==4 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      4.เหงือกด้านหลังฟันกรามล่าง (Retromolar area)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="5"
                      {% if data['position']==5 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      5.เพดานแข็ง (Hard palate)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="6"
                      {% if data['position']==6 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      6.เพดานอ่อน (Soft palate)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="7"
                      {% if data['position']==7 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      7.ลิ้นด้านบนและด้านข้าง (Dorsal and lateral tongue)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="8"
                      {% if data['position']==8 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      8.ใต้ลิ้น (Ventral tongue)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="9"
                      {% if data['position']==9 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      9.พื้นปาก (Floor of mouth)
                    </label>
                  </div>
                </div>

                <div>
                  <label class="mb-1">ชนิดรอยโรค</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="1"
                      {% if data['lesions']==1 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      รอยโรคสีขาว
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="2"
                      {% if data['lesions']==2 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      รอยโรคสีแดง
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="3"
                      {% if data['lesions']==3 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      รอยโรคสีขาวปนแดง
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="4"
                      {% if data['lesions']==4 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      รอยแผลถลอก
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="5"
                      {% if data['lesions']==5 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      ลักษณะเป็นก้อน
                    </label>
                  </div>
                </div>
              </div>

              <div class="mb-3">
                <label for="exampleFormControlTextarea1" class="form-label">ความคิดเห็น</label>
                <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="comment"> {{data['comment']}}</textarea>
              </div>
            {% else %}
              <div class="form-check">
                <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault1" value="เห็นด้วย" checked />
                <label class="form-check-label" for="comment_option">
                  เห็นด้วย
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="comment_option" id="flexRadioDefault2"
                  value="ไม่เห็นด้วย" />
                <label class="form-check-label" for="comment_option">
                  ไม่เห็นด้วย
                </label>
              </div>

              <h5 class="card-title mt-4">
                คำวินิจฉัยเพิ่มเติม
              </h5>

              <div class="d-flex justify-content-lg-start mb-4">
                <div>
                  <label class="mb-1">ตำแหน่งที่ตรวจพบรอยโรค</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="1"
                      {% if data['position']==1 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      1.ริมฝีปากบนและล่าง (Lip)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="2"
                      {% if data['position']==2 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      2.กระพุ้งแก้มด้านขวาด้านซ้าย (Buccal mucosa)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="3"
                      {% if data['position']==3 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      3.เหงือกบนและล่าง (Gingiva)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="4"
                      {% if data['position']==4 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      4.เหงือกด้านหลังฟันกรามล่าง (Retromolar area)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="5"
                      {% if data['position']==5 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      5.เพดานแข็ง (Hard palate)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="6"
                      {% if data['position']==6 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      6.เพดานอ่อน (Soft palate)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="7"
                      {% if data['position']==7 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      7.ลิ้นด้านบนและด้านข้าง (Dorsal and lateral tongue)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="8"
                      {% if data['position']==8 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      8.ใต้ลิ้น (Ventral tongue)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="position" id="flexRadioDefault1" value="9"
                      {% if data['position']==9 %}checked{% endif %} />
                    <label class="form-check-label" for="comment_option">
                      9.พื้นปาก (Floor of mouth)
                    </label>
                  </div>
                </div>

            <div>
              <label class="mb-1">ชนิดรอยโรค</label>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="1"
                  {% if data['lesions']==1 %}checked{% endif %} />
                <label class="form-check-label" for="comment_option">
                  รอยโรคสีขาว
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="2" {%
                  if data['lesions']==2 %}checked{% endif %} />
                <label class="form-check-label" for="comment_option">
                  รอยโรคสีแดง
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1"
                  value="3" {% if data['lesions']==3 %}checked{% endif %} />
                <label class="form-check-label" for="comment_option">
                  รอยโรคสีขาวปนแดง
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="4" {% if
                  data['lesions']==4 %}checked{% endif %} />
                <label class="form-check-label" for="comment_option">
                  รอยแผลถลอก
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="lesions" id="flexRadioDefault1" value="5" {% if
                  data['lesions']==5 %}checked{% endif %} />
                <label class="form-check-label" for="comment_option">
                  ลักษณะเป็นก้อน
                </label>
              </div>
            </div>
              </div>

              <div class="mb-3">
                <label for="exampleFormControlTextarea1" class="form-label">ความคิดเห็น</label>
                <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="comment">{{data['comment']}}</textarea>
              </div>
            {% endif %}
          {% endif %}

          <input class="btn btn-outline-success" type="submit" value="บันทึกความคิดเห็น" />

          {% endif %}
        </div>
      </div>
    </div>
  </form>

{% endif %}
{% endif %}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    $("#seeMoreButton").click(function () {
      var hiddenContent = $("#hiddenContent");
      var button = $("#seeMoreButton");

      if (hiddenContent.is(":hidden")) {
        hiddenContent.slideDown("slow", function () {
          button.text("ปิด");
        });
      } else {
        hiddenContent.slideUp("slow", function () {
          button.text("ดูผลคำวินิจฉัยด้วย AI เพิ่มเติม");
        });
      }
    });
  });
</script>
<style>

  #checkboxYes {
    display: none; 
    border-color: #198754;
    color: #198754;

  }

  #checkboxYes:hover {
    background-color: #198754;
    color: rgb(255, 255, 255);
  }
 </style>
{% endblock %}